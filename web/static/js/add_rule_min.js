var server=location.protocol+"//"+location.hostname+(location.port?":"+location.port:""),branch=[];$(document).ready(function(){$(".card").each(function(){var i=$(this).find("#irrigation_time_wait_group"),t=$(this).find(".irrigation_intervals").val();t<=1||isNaN(t)?i.hide():i.show()}),$(".irrigation_intervals").on("input",function(i){var t=parseInt($(this).val()),a=$(this).closest(".card").find("#irrigation_time_wait_group");t<=1||isNaN(t)?a.hide():a.show()}),$(".remove_card").click(function(){$(this).closest(".card").parent().remove()}),$("#go_plan").click(function(){var i={list:{}};$(".card").each(function(){branch_id=$(this).data("branch_id"),time=$(this).find(".irrigation_minutes").val(),interval=$(this).find(".irrigation_intervals").val(),time_wait=$(this).find(".irrigation_time_wait").val(),date_start=$(this).find(".irrigation_date").val(),time_start=$(this).find(".irrigation_time").val(),i.list[branch_id]={branch_id:branch_id,time:time,interval:interval,time_wait:time_wait,datetime_start:date_start+" "+time_start}}),$.ajax({url:"/add_rule",type:"post",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(i,t){$("#go_plan").addClass("disabled")},success:function(){$("#go_plan").removeClass("disabled"),window.location.replace("/#")},error:function(){alert("error"),$("#go_plan").removeClass("disabled")}})})});