var server=location.protocol+"//"+location.hostname+(location.port?":"+location.port:""),branch=[];$(document).ready(function(){$(".card").each(function(){var i=$(this).find("#irrigation_time_wait_group"),t=$(this).find(".irrigation_intervals").val();t<=1||isNaN(t)?i.hide():i.show()}),$(".irrigation_intervals").on("input",function(i){var t=parseInt($(this).val()),a=$(this).closest(".card").find("#irrigation_time_wait_group");t<=1||isNaN(t)?a.hide():a.show()}),$(".remove_card").click(function(){$(this).closest(".card").parent().remove()}),$("#go_plan").click(function(){var i={rules:[]};$(".card").each(function(){var t=$(this).data("branch_id"),a=$(this).find("h4:first").text(),n=$(this).find(".irrigation_minutes").val(),r=$(this).find(".irrigation_intervals").val(),e=$(this).find(".irrigation_time_wait").val(),o=$(this).find(".irrigation_date").val(),s=$(this).find(".irrigation_time").val();i.rules.push({line_id:t,line_name:a,time:n,intervals:r,time_wait:e,date_start:o,time_start:s,end_date:o,repeat_value:4})}),$.ajax({url:"/add_ongoing_rule",type:"post",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(i,t){$("#go_plan").addClass("disabled")},success:function(){$("#go_plan").removeClass("disabled"),window.location.replace("/ongoing_rules")},error:function(){alert("error"),$("#go_plan").removeClass("disabled")}})})});